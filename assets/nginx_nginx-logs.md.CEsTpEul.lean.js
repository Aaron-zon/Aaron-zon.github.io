import{ax as i,A as a,aQ as t,z as n}from"./chunks/framework.BWRXlwpK.js";const g=JSON.parse('{"title":"Nginx 日志","description":"","frontmatter":{},"headers":[],"relativePath":"nginx/nginx-logs.md","filePath":"nginx/nginx-logs.md"}'),e={name:"nginx/nginx-logs.md"};function l(p,s,h,o,r,k){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="nginx-日志" tabindex="-1">Nginx 日志 <a class="header-anchor" href="#nginx-日志" aria-label="Permalink to &quot;Nginx 日志&quot;">​</a></h1><p>通过日志可以获取到 用户地址信息、跳转来源、终端、以及url访问量等。</p><p>日志的格式在 http块 的 log_format 中可以定义</p><p>log格式：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span></span>
<span class="line"><span>    #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span>    #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>log示例：</p><div class="language-log vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">log</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">227</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> - - [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">04</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/Jul/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2025:18:37:49</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET / HTTP/1.1&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 304</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 612</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;-&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36&quot;</span></span></code></pre></div><ul><li>$remote_addr：客户端 IP 地址。</li><li>$remote_user：客户端用户名。</li><li>$time_local：访问时间 [日期/月份/年份:小时:分钟:秒钟 -时区]。</li><li>$request：请求方式。</li><li>$status：HTTP 响应状态码。</li><li>$body_bytes_sent：发送给客户端的字节数。</li><li>$http_referer：来源页面的 URL，用户从哪个地址请求过来的，如果是新页，则为 &quot;-&quot;。</li><li>$http_user_agent：用户代理字符串（标注用户使用的浏览器，但在浏览器大战后，这个字段已经不再准确）。</li><li>$http_x_forwarded_for: 通过代理服务器来记录客户端的 IP 地址。</li></ul><h2 id="日志分割" tabindex="-1">日志分割 <a class="header-anchor" href="#日志分割" aria-label="Permalink to &quot;日志分割&quot;">​</a></h2><p>由于日志随着时间不断增大，可能会导致查看不便，我们可以将日志按照每天进行分割。</p><p>可以在每天0时进行定时任务，重新命名日志文件，并向nginx发送信号（kill -USR 主进程ID），使nginx重新打开新的日志文件。</p><p>主进程ID可以在 <strong>/logs/nginx.pid</strong> 中或使用命令 <strong>ps -ef | grep nginx</strong> 查看。</p>`,12)]))}const u=i(e,[["render",l]]);export{g as __pageData,u as default};
