import{ax as i,A as a,aQ as n,z as l}from"./chunks/framework.BWRXlwpK.js";const c=JSON.parse('{"title":"安装/使用 php","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"linux/ubuntu/ubuntu-php.md","filePath":"linux/ubuntu/ubuntu-php.md"}'),p={name:"linux/ubuntu/ubuntu-php.md"};function h(e,s,t,k,d,r){return l(),a("div",null,s[0]||(s[0]=[n(`<h1 id="安装-使用-php" tabindex="-1">安装/使用 php <a class="header-anchor" href="#安装-使用-php" aria-label="Permalink to &quot;安装/使用 php&quot;">​</a></h1><p>这里以安装 php8.2 为例。</p><ul><li>php8.2: 基础 PHP 包，PHP 核心运行环境</li><li>php8.2-fpm: PHP-FPM（FastCGI Process Manager），用于 Nginx 或其他 Web 服务器</li><li>php8.2-mysql: MySQL 数据库扩展</li><li>php8.2-xml: XML 扩展</li><li>php8.2-mbstring: 多字节字符串处理扩展</li><li>php8.2-curl: cURL 扩展</li><li>php8.2-zip: ZIP 压缩扩展</li><li>php8.2-bcmath: 高精度数学计算扩展</li><li>php8.2-cli: 命令行使用 PHP</li></ul><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><p>Ubuntu 24 默认源可能还没有 PHP 8.2 包。 我们可以通过 添加第三方源（PPA） 或使用 Ubuntu 官方源可用的 PHP 版本 来解决。</p><h3 id="安装-software-properties-common" tabindex="-1">安装 software-properties-common <a class="header-anchor" href="#安装-software-properties-common" aria-label="Permalink to &quot;安装 software-properties-common&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> software-properties-common</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><p>这个工具可以方便我们添加PPA</p><h3 id="添加-php-官方-ppa" tabindex="-1">添加 PHP 官方 PPA <a class="header-anchor" href="#添加-php-官方-ppa" aria-label="Permalink to &quot;添加 PHP 官方 PPA&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add-apt-repository</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ppa:ondrej/php</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre></div><ul><li><code>ondrej/php</code> 是 Ubuntu 社区最常用的PHP PPA，支持 PHP 7.4 ~ 8.3</li><li>添加之后就可以安装 PHP8.2 了</li></ul><h3 id="安装-php-8-2-以及常用扩展" tabindex="-1">安装 PHP 8.2 以及常用扩展 <a class="header-anchor" href="#安装-php-8-2-以及常用扩展" aria-label="Permalink to &quot;安装 PHP 8.2 以及常用扩展&quot;">​</a></h3><p>· 安装 PHP 8.2 以及常用扩展</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-xml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-mbstring</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-bcmath</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><h3 id="检查安装" tabindex="-1">检查安装 <a class="header-anchor" href="#检查安装" aria-label="Permalink to &quot;检查安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php-fpm8.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><ul><li>显示 PHP 版本信息，确认安装成功。</li></ul><h2 id="部署-laravel" tabindex="-1">部署 Laravel <a class="header-anchor" href="#部署-laravel" aria-label="Permalink to &quot;部署 Laravel&quot;">​</a></h2><p>这是一个部署laravel的项目实例</p><h3 id="部署" tabindex="-1">部署 <a class="header-anchor" href="#部署" aria-label="Permalink to &quot;部署&quot;">​</a></h3><p>前提条件</p><ul><li>已安装 Ubuntu 24.04</li><li>已安装 PHP 8.2</li><li>已安装 Nginx</li></ul><h4 id="laravel-项目放入服务器" tabindex="-1">Laravel 项目放入服务器 <a class="header-anchor" href="#laravel-项目放入服务器" aria-label="Permalink to &quot;Laravel 项目放入服务器&quot;">​</a></h4><p>将 Laravel 项目 <code>lp</code> 放入 <code>/var/www/laravel/lp</code> 目录下。</p><h4 id="配置-env-站点" tabindex="-1">配置 .env 站点 <a class="header-anchor" href="#配置-env-站点" aria-label="Permalink to &quot;配置 .env 站点&quot;">​</a></h4><p><strong>1.创建 .env 文件</strong></p><p>进入 <code>lp</code> 目录，复制 查看是否有 <code>.env</code> 文件，如果没有，复制 <code>.env.example</code> 到 <code>.env</code>。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/laravel/lp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env</span></span></code></pre></div><p><strong>2.生成 Laravel APP_KEY</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> artisan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> key:generate</span></span></code></pre></div><p><strong>3.在配置文件中设置好数据库连接</strong></p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DB_HOST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=xxx.xxx.xxx.xxx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DB_PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=3306</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DB_DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=你的库名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DB_USERNAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=你的用户</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DB_PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=你的密码</span></span></code></pre></div><h4 id="主要目录设置权限" tabindex="-1">主要目录设置权限 <a class="header-anchor" href="#主要目录设置权限" aria-label="Permalink to &quot;主要目录设置权限&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> www-data:www-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/laravel/lp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 755</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/laravel/lp/storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 755</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/laravel/lp/bootstrap/cache</span></span></code></pre></div><p>（www-data 是 Nginx/Apache 的默认用户）</p><h4 id="测试运行" tabindex="-1">测试运行 <a class="header-anchor" href="#测试运行" aria-label="Permalink to &quot;测试运行&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> artisan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serve</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --host=0.0.0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port=8000</span></span></code></pre></div><h4 id="配置生产环境配置文件" tabindex="-1">配置生产环境配置文件 <a class="header-anchor" href="#配置生产环境配置文件" aria-label="Permalink to &quot;配置生产环境配置文件&quot;">​</a></h4><ul><li>这里我们创建一个 <code>lp</code> 文件作为配置文件</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nginx/sites-available/lp</span></span></code></pre></div><p><strong>为什么不用直接改 nginx.conf？</strong></p><ul><li>可维护性强：每个站点一个文件</li><li>方便开启/关闭站点：只需创建或删除软链接</li><li>多人运维更安全：不会修改全局文件</li></ul><p>写入</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/laravel/lp/public;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.php index.html;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /index.php?$query_string;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> \\.php$ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        include </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">snippets/fastcgi-php.conf;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        fastcgi_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">unix:/run/php/php8.2-fpm.sock;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> /\\.ht </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        deny </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>这里要注意 <code>80</code> 端口是默认端口，如果你有其他服务在监听 <code>80</code> 端口，需要先关闭或修改。</li><li>root 后的路径要到 <code>public</code></li></ul><h4 id="启用站点并重启nginx" tabindex="-1">启用站点并重启Nginx <a class="header-anchor" href="#启用站点并重启nginx" aria-label="Permalink to &quot;启用站点并重启Nginx&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建软连接</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nginx/sites-available/lp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nginx/sites-enabled/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查配置是否正常</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启 Nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span></span></code></pre></div><h4 id="访问" tabindex="-1">访问 <a class="header-anchor" href="#访问" aria-label="Permalink to &quot;访问&quot;">​</a></h4><ul><li>访问 <code>http://你的服务器IP:端口</code>，如果一切正常，你应该能看到 Laravel 的欢迎页面。</li></ul><h3 id="问题" tabindex="-1">问题 <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题&quot;">​</a></h3><p><strong>1.No input file specified.</strong></p><p>访问 <code>http://你的服务器IP:端口</code>，出现 <code>No input file specified.</code></p><p>对应方法:</p><p>打开 <code>/etc/nginx/sites-available/lp/public</code> 查看是否有 <code>.user.ini</code> 文件。</p><p>如果设置了 <code>open_basedir</code>，可以先注释掉。</p><p>保存后访问 <code>http://你的服务器IP:端口</code>，如果一切正常，你应该能看到 Laravel 的欢迎页面。</p>`,56)]))}const g=i(p,[["render",h]]);export{c as __pageData,g as default};
